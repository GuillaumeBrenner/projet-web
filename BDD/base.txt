CREATE TABLE personne(
   id_personne INT AUTO_INCREMENT,
   Nom VARCHAR(50),
   Prenom VARCHAR(50),
   sexe VARCHAR(50),
   PRIMARY KEY(id_personne)
);

CREATE TABLE Entreprise(
   id_entreprise INT AUTO_INCREMENT,
   nom VARCHAR(50) NOT NULL,
   photo_profil VARCHAR(50),
   validite BOOLEAN,
   nombre_etudiant INT,
   PRIMARY KEY(id_entreprise)
);

CREATE TABLE ville(
   id_ville INT AUTO_INCREMENT,
   ville VARCHAR(50),
   code_postal INT,
   région VARCHAR(50),
   PRIMARY KEY(id_ville)
);

CREATE TABLE type_compte(
   id_type INT AUTO_INCREMENT,
   type VARCHAR(50),
   PRIMARY KEY(id_type)
);

CREATE TABLE Secteur_activité(
   id_secteur INT AUTO_INCREMENT,
   secteur VARCHAR(50),
   PRIMARY KEY(id_secteur)
);

CREATE TABLE Promotion(
   id_promotion INT AUTO_INCREMENT,
   nom_promo VARCHAR(50),
   PRIMARY KEY(id_promotion)
);

CREATE TABLE compte(
   id_c INT AUTO_INCREMENT,
   login VARCHAR(50),
   photo_profil VARCHAR(100),
   mdp VARCHAR(50),
   validite BOOLEAN,
   id_entreprise INT,
   id_personne INT NOT NULL,
   id_type INT NOT NULL,
   PRIMARY KEY(id_c),
   UNIQUE(login),
   FOREIGN KEY(id_entreprise) REFERENCES Entreprise(id_entreprise),
   FOREIGN KEY(id_personne) REFERENCES Personne(id_personne),
   FOREIGN KEY(id_type) REFERENCES type_compte(id_type)
);

CREATE TABLE Site(
   id_site INT AUTO_INCREMENT,
   id_ville INT NOT NULL,
   id_entreprise INT NOT NULL,
   PRIMARY KEY(id_site),
   FOREIGN KEY(id_ville) REFERENCES ville(id_ville),
   FOREIGN KEY(id_entreprise) REFERENCES Entreprise(id_entreprise)
);

CREATE TABLE Offre(
   id_offre INT AUTO_INCREMENT,
   Titre VARCHAR(50),
   Description TEXT,
   Durée VARCHAR(50),
   Date_post DATE,
   nombre_places SMALLINT,
   Remuneration FLOAT,
   valide BOOLEAN,
   id_site INT NOT NULL,
   PRIMARY KEY(id_offre),
   FOREIGN KEY(id_site) REFERENCES Site(id_site)
);

CREATE TABLE postule(
   id_c INT,
   id_offre INT,
   cv TEXT,
   ldm TEXT,
   PRIMARY KEY(id_c, id_offre),
   FOREIGN KEY(id_c) REFERENCES compte(id_c),
   FOREIGN KEY(id_offre) REFERENCES Offre(id_offre)
);

CREATE TABLE WishList(
   id_c INT,
   id_offre INT,
   PRIMARY KEY(id_c, id_offre),
   FOREIGN KEY(id_c) REFERENCES compte(id_c),
   FOREIGN KEY(id_offre) REFERENCES Offre(id_offre)
);

CREATE TABLE avoir(
   id_entreprise INT,
   id_secteur INT,
   PRIMARY KEY(id_entreprise, id_secteur),
   FOREIGN KEY(id_entreprise) REFERENCES Entreprise(id_entreprise),
   FOREIGN KEY(id_secteur) REFERENCES Secteur_activité(id_secteur)
);

CREATE TABLE evaluation(
   id_c INT,
   id_entreprise INT,
   note SMALLINT,
   commentaire TEXT,
   PRIMARY KEY(id_c, id_entreprise),
   FOREIGN KEY(id_c) REFERENCES compte(id_c),
   FOREIGN KEY(id_entreprise) REFERENCES Entreprise(id_entreprise)
);

CREATE TABLE centre(
   id_c INT,
   id_ville INT,
   PRIMARY KEY(id_c, id_ville),
   FOREIGN KEY(id_c) REFERENCES compte(id_c),
   FOREIGN KEY(id_ville) REFERENCES ville(id_ville)
);

CREATE TABLE etre_promo(
   id_c INT,
   id_promotion INT,
   PRIMARY KEY(id_c, id_promotion),
   FOREIGN KEY(id_c) REFERENCES compte(id_c),
   FOREIGN KEY(id_promotion) REFERENCES Promotion(id_promotion)
);

CREATE TABLE accepter(
   id_c INT,
   id_offre INT,
   PRIMARY KEY(id_c, id_offre),
   FOREIGN KEY(id_c) REFERENCES compte(id_c),
   FOREIGN KEY(id_offre) REFERENCES Offre(id_offre)
);

INSERT INTO type_compte (type) VALUES ('Admin'), ('Pro'), ('Etudiant') , ('Pilote');

INSERT INTO personne (Nom , Prenom , sexe) VALUES ( 'Vignaud' , 'Mathéo' , 'H') , ( 'Amallah' ,  'Youssef' , 'H') , ('Hounkpati' , 'Guillaume' , 'H') , ('Yohann-Sterling' , 'Nsome' , 'H') ; 

INSERT INTO compte (login , mdp , validite , id_type , id_personne)  VALUES ('mvignaud' , 'azerty' , 1 , (SELECT id_type FROM type_compte WHERE type = 'Admin') , (SELECT id_personne FROM personne WHERE Nom = 'Vignaud' AND Prenom = 'Mathéo')) , ('yamallah' , 'rololo' , 1 , (SELECT id_type FROM type_compte WHERE type = 'Admin') , (SELECT id_personne FROM personne WHERE Nom = 'Amallah' AND Prenom = 'Youssef')) ,('ghounkpati' , 'mrsérieux' , 1 , (SELECT id_type FROM type_compte WHERE type = 'Admin') , (SELECT id_personne FROM personne WHERE Nom = 'Hounkpati' AND Prenom = 'Guillaume')) , ('ynsome' , 'lepetitfarceur' , 1 , (SELECT id_type FROM type_compte WHERE type = 'Admin') , (SELECT id_personne FROM personne WHERE Nom = 'Yohann-Sterling' AND Prenom = 'Nsome'));
